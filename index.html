<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ポートフォリオサイト</title>
    <link rel="stylesheet" href="style.css">
    <script type="module" src="https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js"></script>
    <script type="module" src="./firebase.js"></script>
    <script type="module" src="./auth.js"></script>
</head>
<body>
    <div class="lang-buttons">
        <button id="lang-en" class="lang-button">EN</button>
        <button id="lang-ja" class="lang-button">JP</button>
    </div>

    <div class="container">
        <div class="form-section">
            <h1 id="registerTitle">ユーザー登録</h1>
            <input type="email" id="email" placeholder="メールアドレス" required>
            <input type="password" id="password" placeholder="パスワード" required>
            <button id="registerButton" class="small-button">登録</button>
        </div>

        <div class="form-section">
            <h1 id="loginTitle">ログイン</h1>
            <input type="email" id="loginEmail" placeholder="メールアドレス" required>
            <input type="password" id="loginPassword" placeholder="パスワード" required>
            <button id="loginButton" class="small-button">ログイン</button>
        </div>

        <div id="errorModal" class="modal">
            <div class="modal-content">
                <span class="close" id="closeModal">&times;</span>
                <p id="modalMessage"></p>
            </div>
        </div>
    </div>

    <script>
        const languageData = {
            ja: {
                registerTitle: "ユーザー登録",
                loginTitle: "ログイン",
                registerButton: "登録",
                loginButton: "ログイン",
                modalClose: "閉じる",
                registrationSuccess: "ユーザー登録が成功しました。",
                registrationError: "登録に失敗しました。",
                loginSuccess: "ログイン成功",
                loginError: "ログインに失敗しました。",
                emailPlaceholder: "メールアドレス",
                passwordPlaceholder: "パスワード",
            },
            en: {
                registerTitle: "User Registration",
                loginTitle: "Login",
                registerButton: "Register",
                loginButton: "Login",
                modalClose: "Close",
                registrationSuccess: "User registration was successful.",
                registrationError: "Registration failed.",
                loginSuccess: "Login successful.",
                loginError: "Login failed.",
                emailPlaceholder: "Email Address",
                passwordPlaceholder: "Password",
            }
        };

        let currentLanguage = localStorage.getItem('language') || 'ja'; // ローカルストレージから取得

        document.getElementById('lang-ja').addEventListener('click', () => {
            currentLanguage = 'ja';
            localStorage.setItem('language', 'ja'); // ローカルストレージに保存
            updateUI();
        });

        document.getElementById('lang-en').addEventListener('click', () => {
            currentLanguage = 'en';
            localStorage.setItem('language', 'en'); // ローカルストレージに保存
            updateUI();
        });

        function updateUI() {
            document.getElementById('registerTitle').textContent = languageData[currentLanguage].registerTitle;
            document.getElementById('loginTitle').textContent = languageData[currentLanguage].loginTitle;
            document.getElementById('registerButton').textContent = languageData[currentLanguage].registerButton;
            document.getElementById('loginButton').textContent = languageData[currentLanguage].loginButton;
            document.getElementById('closeModal').textContent = languageData[currentLanguage].modalClose;

            // プレースホルダーの更新
            document.getElementById('email').placeholder = languageData[currentLanguage].emailPlaceholder;
            document.getElementById('password').placeholder = languageData[currentLanguage].passwordPlaceholder;
            document.getElementById('loginEmail').placeholder = languageData[currentLanguage].emailPlaceholder;
            document.getElementById('loginPassword').placeholder = languageData[currentLanguage].passwordPlaceholder;
        }

        // Firebaseの初期化とauthの取得
        const { auth } = initializeFirebase(); // Firebaseの初期化

        // ユーザー登録処理
        document.getElementById('registerButton').addEventListener('click', async () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                await createUserWithEmailAndPassword(auth, email, password);
                alert(languageData[currentLanguage].registrationSuccess); // 言語に応じたメッセージ
            } catch (error) {
                console.error("ユーザー登録中のエラー:", error);
                alert(languageData[currentLanguage].registrationError); // 言語に応じたメッセージ
            }
        });

        // ログイン処理
        document.getElementById('loginButton').addEventListener('click', async () => {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                await signInWithEmailAndPassword(auth, email, password);
                alert(languageData[currentLanguage].loginSuccess); // 言語に応じたメッセージ
                window.location.href = 'user.html'; // ユーザーページにリダイレクト
            } catch (error) {
                console.error("ログイン中のエラー:", error);
                alert(languageData[currentLanguage].loginError); // 言語に応じたメッセージ
            }
        });

        // 初期UIの更新
        updateUI();
    </script>
</body>
</html>
